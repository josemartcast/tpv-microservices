<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.tpv.desktop.ui.history.HistoryController"
            prefWidth="1100" prefHeight="650">

  <top>
    <HBox spacing="10" alignment="CENTER_LEFT" style="-fx-padding: 12;">
      <Label text="Tickets History (OPEN)" style="-fx-font-size: 18px; -fx-font-weight: bold;"/>
      <Region HBox.hgrow="ALWAYS"/>
      <Button text="Refrescar" onAction="#onRefresh"/>
    </HBox>
  </top>

  <center>
    <SplitPane dividerPositions="0.45">

      <!-- LISTA -->
      <VBox spacing="10" style="-fx-padding: 12;">
        <TableView fx:id="ticketsTable" prefHeight="600">
          <columns>
            <TableColumn fx:id="colId" text="#" prefWidth="80"/>
            <TableColumn fx:id="colTotal" text="Total" prefWidth="120"/>
            <TableColumn fx:id="colCreated" text="Fecha" prefWidth="200"/>
          </columns>
        </TableView>
        <Label fx:id="listErrorLabel" text="" style="-fx-text-fill: red;"/>
      </VBox>

      <!-- DETALLE -->
      <VBox spacing="10" style="-fx-padding: 12;">
        <HBox spacing="10" alignment="CENTER_LEFT">
          <Label fx:id="detailTitle"
                 text="Selecciona un ticket"
                 style="-fx-font-weight: bold; -fx-font-size: 14px;"/>
          <Region HBox.hgrow="ALWAYS"/>
          <Button fx:id="openInSalesBtn" text="Abrir en Sales" onAction="#onOpenInSales"/>
        </HBox>

        <HBox spacing="10" alignment="CENTER_LEFT">
          <Label text="Total:"/>
          <Label fx:id="detailTotal" text="-"/>
          <Label text="Pagado:"/>
          <Label fx:id="detailPaid" text="-"/>
          <Label text="Restante:"/>
          <Label fx:id="detailRemaining" text="-"/>
        </HBox>

        <Label text="Líneas" style="-fx-font-weight: bold;"/>
        <TableView fx:id="linesTable" prefHeight="280">
          <columns>
            <TableColumn fx:id="colLineName" text="Producto" prefWidth="240"/>
            <TableColumn fx:id="colLineQty" text="Qty" prefWidth="70"/>
            <TableColumn fx:id="colLineUnit" text="€/u" prefWidth="90"/>
            <TableColumn fx:id="colLineTotal" text="Total" prefWidth="90"/>
          </columns>
        </TableView>

        <Label text="Pagos" style="-fx-font-weight: bold;"/>
        <TableView fx:id="paymentsTable" prefHeight="220">
          <columns>
            <TableColumn fx:id="colPayMethod" text="Método" prefWidth="120"/>
            <TableColumn fx:id="colPayAmount" text="Importe" prefWidth="120"/>
            <TableColumn fx:id="colPayDate" text="Fecha" prefWidth="200"/>
          </columns>
        </TableView>

        <Label fx:id="detailErrorLabel" text="" style="-fx-text-fill: red;"/>
      </VBox>

    </SplitPane>
  </center>

</BorderPane>
